{"version":3,"file":"loadIcon.js","sources":["../../src/utils/loadIcon.ts"],"sourcesContent":["import type { TMetadata, TType } from '@web3icons/common'\nimport type { IconComponent } from '../types.js'\nimport { toPascalCase } from './naming-conventions.js'\n\ntype DynamicImportFn = () => Promise<{ default: IconComponent }>\ntype DynamicIconImports = Record<string, DynamicImportFn>\n\nconst iconCache = new Map<string, Promise<IconComponent>>()\nlet dynamicIconImports: DynamicIconImports | null = null\n\nconst getDynamicIconImports = async (): Promise<DynamicIconImports> => {\n  if (!dynamicIconImports) {\n    // Static string import - allows bundlers to analyze and code-split\n    const module = await import('@web3icons/react/dynamicIconImports')\n    dynamicIconImports = module.default as DynamicIconImports\n  }\n  return dynamicIconImports!\n}\n\nexport const preloadIcon = (type: string, metadata: TMetadata): void => {\n  const key = getIconKey(type, metadata)\n  if (!iconCache.has(key)) {\n    loadIcon(type, metadata)\n  }\n}\n\n/**\n * parse fileName to extract type and name\n * format must be \"type:name\" where type is one of: network, token, wallet, exchange\n * examples:\n * - \"network:ethereum\" - references network icon\n * - \"token:usdc\" - references token icon\n * - \"wallet:metamask\" - references wallet icon\n */\nconst parseFilePath = (filePath: string): { type: TType; name: string } => {\n  const parts = filePath.split(':')\n  if (parts.length !== 2) {\n    throw new Error(\n      `Invalid filePath format: \"${filePath}\". Expected format: \"type:name\" (e.g., \"network:ethereum\")`,\n    )\n  }\n  return { type: parts[0] as TType, name: parts[1]! }\n}\n\nexport const getIconKey = (type: string, metadata: TMetadata): string => {\n  const { type: iconType, name: iconName } = parseFilePath(metadata.filePath)\n\n  // generate component name based on the icon's type\n  const componentName =\n    iconType === 'token'\n      ? iconName.replace(/[- ]+/g, '_').toUpperCase()\n      : toPascalCase(iconName)\n\n  return `${iconType.charAt(0).toUpperCase()}${iconType.slice(1)}${componentName}`\n}\n\nexport const loadIcon = (\n  type: string,\n  metadata: TMetadata,\n): Promise<IconComponent> => {\n  const key = getIconKey(type, metadata)\n\n  if (!iconCache.has(key)) {\n    const importPromise = getDynamicIconImports()\n      .then((imports) => {\n        const importFn = imports[key]\n        if (!importFn) {\n          console.warn(`No dynamic import found for icon: ${key}`)\n          return null\n        }\n        return importFn().then((module) => module.default)\n      })\n      .catch((error) => {\n        console.warn(`Failed to load icon: ${key}`, error)\n        return null\n      })\n\n    iconCache.set(key, importPromise as Promise<IconComponent>)\n  }\n\n  return iconCache.get(key)!\n}\n"],"names":[],"mappings":";;AAOA,MAAM,SAAS,GAAG,IAAI,GAAG,EAAkC;AAC3D,IAAI,kBAAkB,GAA8B,IAAI;AAExD,MAAM,qBAAqB,GAAG,YAAwC;IACpE,IAAI,CAAC,kBAAkB,EAAE;;AAEvB,QAAA,MAAM,MAAM,GAAG,MAAM,OAAO,qCAAqC,CAAC;AAClE,QAAA,kBAAkB,GAAG,MAAM,CAAC,OAA6B;IAC3D;AACA,IAAA,OAAO,kBAAmB;AAC5B,CAAC;AASD;;;;;;;AAOG;AACH,MAAM,aAAa,GAAG,CAAC,QAAgB,KAAmC;IACxE,MAAM,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC;AACjC,IAAA,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;AACtB,QAAA,MAAM,IAAI,KAAK,CACb,6BAA6B,QAAQ,CAAA,0DAAA,CAA4D,CAClG;IACH;AACA,IAAA,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC,CAAU,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC,CAAE,EAAE;AACrD,CAAC;MAEY,UAAU,GAAG,CAAC,IAAY,EAAE,QAAmB,KAAY;AACtE,IAAA,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,aAAa,CAAC,QAAQ,CAAC,QAAQ,CAAC;;AAG3E,IAAA,MAAM,aAAa,GACjB,QAAQ,KAAK;UACT,QAAQ,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,WAAW;AAC7C,UAAE,YAAY,CAAC,QAAQ,CAAC;IAE5B,OAAO,CAAA,EAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA,EAAG,aAAa,EAAE;AAClF;MAEa,QAAQ,GAAG,CACtB,IAAY,EACZ,QAAmB,KACO;IAC1B,MAAM,GAAG,GAAG,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC;IAEtC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;QACvB,MAAM,aAAa,GAAG,qBAAqB;AACxC,aAAA,IAAI,CAAC,CAAC,OAAO,KAAI;AAChB,YAAA,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC;YAC7B,IAAI,CAAC,QAAQ,EAAE;AACb,gBAAA,OAAO,CAAC,IAAI,CAAC,qCAAqC,GAAG,CAAA,CAAE,CAAC;AACxD,gBAAA,OAAO,IAAI;YACb;AACA,YAAA,OAAO,QAAQ,EAAE,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,MAAM,CAAC,OAAO,CAAC;AACpD,QAAA,CAAC;AACA,aAAA,KAAK,CAAC,CAAC,KAAK,KAAI;YACf,OAAO,CAAC,IAAI,CAAC,CAAA,qBAAA,EAAwB,GAAG,CAAA,CAAE,EAAE,KAAK,CAAC;AAClD,YAAA,OAAO,IAAI;AACb,QAAA,CAAC,CAAC;AAEJ,QAAA,SAAS,CAAC,GAAG,CAAC,GAAG,EAAE,aAAuC,CAAC;IAC7D;AAEA,IAAA,OAAO,SAAS,CAAC,GAAG,CAAC,GAAG,CAAE;AAC5B;;;;"}